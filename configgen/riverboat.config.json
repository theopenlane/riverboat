{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/theopenlane/riverboat/config/config.-config",
  "$defs": {
    "[]river.Queue": {
      "items": {
        "$ref": "#/$defs/river.Queue"
      },
      "type": "array"
    },
    "corejobs.ClearTrustCenterCacheWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/corejobs.ClearTrustCenterCacheWorkerConfig",
          "description": "the configuration for clearing trust center cache"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.ClearTrustCenterCacheWorkerConfig": {
      "properties": {
        "objectstorage": {
          "$ref": "#/$defs/corejobs.ProviderConfig",
          "description": "the object storage configuration for R2"
        },
        "enabled": {
          "type": "boolean"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.CreateCustomDomainWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/corejobs.CustomDomainConfig",
          "description": "the configuration for custom domain creation"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.CreatePirschDomainWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/corejobs.PirschDomainConfig",
          "description": "the configuration for pirsch domain creation"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.CreatePreviewDomainWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/corejobs.PreviewDomainConfig",
          "description": "the configuration for preview domain creation"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.CustomDomainConfig": {
      "properties": {
        "openlaneapihost": {
          "type": "string"
        },
        "openlaneapitoken": {
          "type": "string"
        },
        "enabled": {
          "type": "boolean"
        },
        "cloudflareapikey": {
          "type": "string"
        },
        "validateinterval": {
          "type": "integer"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "validateinterval"
      ]
    },
    "corejobs.DeleteCustomDomainWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/corejobs.CustomDomainConfig",
          "description": "the configuration for custom domain deletion"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.DeletePirschDomainWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/corejobs.PirschDomainConfig",
          "description": "the configuration for pirsch domain deletion"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.DeletePreviewDomainConfig": {
      "properties": {
        "openlaneapihost": {
          "type": "string"
        },
        "openlaneapitoken": {
          "type": "string"
        },
        "enabled": {
          "type": "boolean"
        },
        "cloudflareapikey": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.DeletePreviewDomainWorker": {
      "properties": {
        "Config": {
          "$ref": "#/$defs/corejobs.DeletePreviewDomainConfig"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.PirschDomainConfig": {
      "properties": {
        "openlaneapihost": {
          "type": "string"
        },
        "openlaneapitoken": {
          "type": "string"
        },
        "enabled": {
          "type": "boolean"
        },
        "pirschclientid": {
          "type": "string"
        },
        "pirschclientsecret": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.PreviewDomainConfig": {
      "properties": {
        "openlaneapihost": {
          "type": "string"
        },
        "openlaneapitoken": {
          "type": "string"
        },
        "enabled": {
          "type": "boolean"
        },
        "cloudflareapikey": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.ProviderConfig": {
      "properties": {
        "bucket": {
          "type": "string"
        },
        "endpoint": {
          "type": "string"
        },
        "credentials": {
          "$ref": "#/$defs/corejobs.ProviderCredentials"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.ProviderCredentials": {
      "properties": {
        "accesskeyid": {
          "type": "string"
        },
        "secretaccesskey": {
          "type": "string"
        },
        "accountid": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.UpdatePirschDomainWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/corejobs.PirschDomainConfig",
          "description": "the configuration for pirsch domain update"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.ValidateCustomDomainWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/corejobs.CustomDomainConfig",
          "description": "the configuration for custom domain validation"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.ValidatePreviewDomainConfig": {
      "properties": {
        "openlaneapihost": {
          "type": "string"
        },
        "openlaneapitoken": {
          "type": "string"
        },
        "enabled": {
          "type": "boolean"
        },
        "cloudflareapikey": {
          "type": "string"
        },
        "maxsnoozes": {
          "type": "integer"
        },
        "snoozeduration": {
          "type": "integer"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "maxsnoozes",
        "snoozeduration"
      ]
    },
    "corejobs.ValidatePreviewDomainWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/corejobs.ValidatePreviewDomainConfig",
          "description": "the configuration for preview domain validation"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.WatermarkDocWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/corejobs.WatermarkWorkerConfig",
          "description": "the configuration for watermarking"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "corejobs.WatermarkWorkerConfig": {
      "properties": {
        "openlaneapihost": {
          "type": "string"
        },
        "openlaneapitoken": {
          "type": "string"
        },
        "enabled": {
          "type": "boolean"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "dbxclient.Config": {
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable the dbx client"
        },
        "baseUrl": {
          "type": "string",
          "description": "Base URL for the dbx service"
        },
        "endpoint": {
          "type": "string",
          "description": "Endpoint for the graphql api"
        },
        "debug": {
          "type": "boolean",
          "description": "Enable debug mode"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "jobs.DatabaseWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/dbxclient.Config",
          "description": "the database configuration"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "DatabaseWorker is a worker to create a dedicated database for an organization"
    },
    "jobs.DeleteExportContentWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/jobs.DeleteExportWorkerConfig",
          "description": "the configuration for deleting exports"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "DeleteExportContentWorker deletes exports that are older than the configured cutoff duration"
    },
    "jobs.DeleteExportWorkerConfig": {
      "properties": {
        "openlaneapihost": {
          "type": "string",
          "description": "OpenlaneAPIHost is the host URL for the Openlane API"
        },
        "openlaneapitoken": {
          "type": "string",
          "description": "OpenlaneAPIToken is the API token for authenticating with the Openlane API"
        },
        "enabled": {
          "type": "boolean"
        },
        "interval": {
          "type": "integer"
        },
        "cutoffduration": {
          "type": "integer",
          "description": "CutoffDuration defines the tolerance for exports. If you set 30 minutes, all exports older than 30 minutes\nat the time of job execution will be deleted"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "interval",
        "cutoffduration"
      ],
      "description": "DeleteExportWorkerConfig holds the configuration for the delete export worker"
    },
    "jobs.EmailConfig": {
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "enable or disable the email worker"
        },
        "devmode": {
          "type": "boolean",
          "description": "enable dev mode"
        },
        "testdir": {
          "type": "string",
          "description": "the directory to use for dev mode"
        },
        "token": {
          "type": "string",
          "description": "the token to use for the email provider"
        },
        "fromemail": {
          "type": "string",
          "description": "FromEmail is the email address to use as the sender"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "EmailConfig contains the configuration for the email worker"
    },
    "jobs.EmailWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/jobs.EmailConfig",
          "description": "the email configuration"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "EmailWorker is a worker to send emails using the resend email provider the config defaults to dev mode, which will write the email to a file using the mock provider a token is required to send emails using the actual resend provider"
    },
    "jobs.ExportContentWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/jobs.ExportWorkerConfig",
          "description": "the configuration for exporting"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "ExportContentWorker exports the content into csv and makes it downloadable"
    },
    "jobs.ExportWorkerConfig": {
      "properties": {
        "openlaneapihost": {
          "type": "string",
          "description": "OpenlaneAPIHost is the host URL for the Openlane API"
        },
        "openlaneapitoken": {
          "type": "string",
          "description": "OpenlaneAPIToken is the API token for authenticating with the Openlane API"
        },
        "enabled": {
          "type": "boolean"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "ExportWorkerConfig configuration for the export content worker"
    },
    "jobs.OpenlaneConfig": {
      "properties": {
        "openlaneapihost": {
          "type": "string",
          "description": "OpenlaneAPIHost is the host URL for the Openlane API"
        },
        "openlaneapitoken": {
          "type": "string",
          "description": "OpenlaneAPIToken is the API token for authenticating with the Openlane API"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "OpenlaneConfig contains the configuration for connecting to the Openlane API."
    },
    "jobs.SlackConfig": {
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "enable or disable the slack worker"
        },
        "devmode": {
          "type": "boolean",
          "description": "enable dev mode"
        },
        "token": {
          "type": "string",
          "description": "the token to use for the slack app"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "SlackConfig configures the Slack worker."
    },
    "jobs.SlackWorker": {
      "properties": {
        "config": {
          "$ref": "#/$defs/jobs.SlackConfig",
          "description": "the slack configuration"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "SlackWorker sends messages to Slack."
    },
    "river.Config": {
      "properties": {
        "databasehost": {
          "type": "string",
          "description": "DatabaseHost for connecting to the postgres database"
        },
        "queues": {
          "$ref": "#/$defs/[]river.Queue",
          "description": "Queues to be enabled on the server, if not provided, a default queue is created"
        },
        "workers": {
          "$ref": "#/$defs/river.Workers",
          "description": "Workers to be enabled on the server"
        },
        "trustcenterworkers": {
          "$ref": "#/$defs/trustcenter.Workers",
          "description": "TrustCenterWorkers holds additional worker configurations based on build tags"
        },
        "defaultmaxretries": {
          "type": "integer",
          "description": "DefaultMaxRetries is the maximum number of retries for failed jobs, this can be set differently per job"
        },
        "metrics": {
          "$ref": "#/$defs/riverqueue.MetricsConfig",
          "description": "Metrics enables or disables metrics collection"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Config is the configuration for the river server"
    },
    "river.Queue": {
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the queue"
        },
        "maxworkers": {
          "type": "integer",
          "description": "MaxWorkers allotted for the queue"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Queue is the configuration for a queue"
    },
    "river.Workers": {
      "properties": {
        "openlaneconfig": {
          "$ref": "#/$defs/jobs.OpenlaneConfig",
          "description": "OpenlaneConfig configuration for openlane jobs, this is shared across multiple workers\nif a worker needs specific configuration, it can be set in the worker's config"
        },
        "emailworker": {
          "$ref": "#/$defs/jobs.EmailWorker",
          "description": "EmailWorker configuration for sending emails"
        },
        "databaseworker": {
          "$ref": "#/$defs/jobs.DatabaseWorker",
          "description": "DatabaseWorker configuration for creating databases using openlane/dbx"
        },
        "exportcontentworker": {
          "$ref": "#/$defs/jobs.ExportContentWorker",
          "description": "ExportContentWorker configuration for exporting content"
        },
        "deleteexportcontentworker": {
          "$ref": "#/$defs/jobs.DeleteExportContentWorker",
          "description": "DeleteExportContentWorker configuration for batch deleting exports and clogging object storage"
        },
        "slackworker": {
          "$ref": "#/$defs/jobs.SlackWorker",
          "description": "SlackWorker configuration for sending Slack messages"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "Workers that will be enabled on the server"
    },
    "riverqueue.MetricsConfig": {
      "properties": {
        "enablemetrics": {
          "type": "boolean",
          "description": "Enable toggles otel metrics middleware"
        },
        "metricsdurationunit": {
          "type": "string",
          "description": "DurationUnit sets the duration unit for metrics"
        },
        "enablesemanticmetrics": {
          "type": "boolean",
          "description": "EnableSemanticMetrics toggles semantic metrics"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "description": "MetricsConfig is the configuration for metrics"
    },
    "trustcenter.Workers": {
      "properties": {
        "openlaneconfig": {
          "$ref": "#/$defs/jobs.OpenlaneConfig"
        },
        "createcustomdomainworker": {
          "$ref": "#/$defs/corejobs.CreateCustomDomainWorker"
        },
        "validatecustomdomainworker": {
          "$ref": "#/$defs/corejobs.ValidateCustomDomainWorker"
        },
        "deletecustomdomainworker": {
          "$ref": "#/$defs/corejobs.DeleteCustomDomainWorker"
        },
        "watermarkdocworker": {
          "$ref": "#/$defs/corejobs.WatermarkDocWorker"
        },
        "createpirschdomainworker": {
          "$ref": "#/$defs/corejobs.CreatePirschDomainWorker"
        },
        "deletepirschdomainworker": {
          "$ref": "#/$defs/corejobs.DeletePirschDomainWorker"
        },
        "updatepirschdomainworker": {
          "$ref": "#/$defs/corejobs.UpdatePirschDomainWorker"
        },
        "createpreviewdomainworker": {
          "$ref": "#/$defs/corejobs.CreatePreviewDomainWorker"
        },
        "deletepreviewdomainworker": {
          "$ref": "#/$defs/corejobs.DeletePreviewDomainWorker"
        },
        "validatepreviewdomainworker": {
          "$ref": "#/$defs/corejobs.ValidatePreviewDomainWorker"
        },
        "clearTrustCenterCacheWorker": {
          "$ref": "#/$defs/corejobs.ClearTrustCenterCacheWorker"
        }
      },
      "additionalProperties": false,
      "type": "object"
    }
  },
  "properties": {
    "refreshInterval": {
      "type": "integer"
    },
    "river": {
      "$ref": "#/$defs/river.Config"
    }
  },
  "additionalProperties": false,
  "type": "object"
}